{% extends 'checkout/base.html' %}

{% block content %}
{% load humanize %}

<script>

$('body').on('hidden.bs.modal', '.modal', function () {
  $(this).removeData('bs.modal');
});

</script>


<div class="col-md-12 main">
  <h1 class="page-header">Dashboard</h1>
  <div class="row">

{% for person in requests %}
	<div class="col-md-6">
      <div class="panel panel-warning">
        <div class="panel-heading">
          <div class="panel-title">
      <a href="{% url 'checkout.views.person_detail' pk=person.pk %}">{{ person }}</a>
    </div>
  </div>
  <div class="panel-body">
           <div class="table-responsive">
            <table id="myTable" class="table table-striped table-condensed">
<thead>
      <tr>
      <th>Item</th>
      <th>Serial</th>
      <th>Description</th>
      <th>Action</th>
    </tr>
</thead>
  {% for request in person.requests %}

      <tr>
      <td><a data-toggle="modal" href="{% url 'checkout.views.item_popup' pk=request.item.pk %}" data-target="#myModal">{{ request.item }}</a></td>
      <td>{{ request.item.serial }}</td>
      <td>{{ request.item.description }}</td>
      <td><a class="action-link text-success" role="button" href="{% url 'checkout.views.checkout_item' p=person.pk i=request.item.pk %}">approve</a> | <a class="action-link text-danger" role="button" href="{% url 'checkout.views.cancel_request' request.pk %}">cancel</a></td>
      </tr>
    {% endfor %}
</table>
</div>
  </div>
</div>
</div>
{% endfor %}



{% for person in active_items %}
<div class="col-md-6">
<div class="panel panel-primary">
  <div class="panel-heading">
    <div class="panel-title">
      <a href="{% url 'checkout.views.person_detail' pk=person.pk %}">{{ person }}</a>
    </div>
  </div>
  <div class="panel-body">
    <div class="table-responsive">
      <table id="myTable" class="table table-striped table-condensed">
<thead>
      <tr>
      <th>Item</th>
      <th>Description</th>
      <th>Out</th>
      <th>Action</th>
    </tr>
</thead>
  {% for transaction in person.inventory %}
      <tr>
      <td><a data-toggle="modal" href="{% url 'checkout.views.item_popup' pk=transaction.item.pk %}" data-target="#myModal">
{{ transaction.item }}</a></td>
      <td>{{ transaction.item.description }}</td>
      <td>{{ transaction.time_out|naturaltime }}</td>
      <td><a class="action-link" role="button" href="{% url 'checkout.views.item_checkin' pk=transaction.pk %}">check in</a></td>
      </tr>
    {% endfor %}
</table>
</div>
</div> <!-- panel-body -->
</div> <!-- panel -->
</div> <!-- col -->
{% endfor %}

  </div>  <!-- row -->

</div>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" modal-lg>
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                 <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body"><div class="te"></div></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- /.modal -->

{% endblock content %}
