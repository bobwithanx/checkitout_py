{% extends 'checkout/base.html' %}
{% load staticfiles %}
{% load i18n %}

{% block content %}

<div class="row">
  <div class="col-md-12">
    <div class="section">
      <h1>Returns</h1>
    </div>
  </div>
</div>
<div class="row">
  {% if borrowers|length > 0 %}
    <div class="col-xs-12 col-sm-12 col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="panel-title">
            Return Item
          </div>
        </div>
        <div class="panel-body">
          <form action="{% url 'checkout.views.quick_checkin' %}" method="POST" role="form" class="form-inline">
            {% csrf_token %}
            <div class="form-group">
              <input autofocus text="search" name="barcode" id="search" value="" class="form-control" placeholder="Enter inventory tag"/>
              <button class="btn btn-primary" type="submit">Go</button>
            </div>
          </form>
          {% if status == 0 %}
            <div class="alert-message alert-message-success" role="alert">
              <h4>Success</h4>
              <strong>{{ status_object }}</strong> was checked in.
            </div>
          {% elif status == 1 %}
            <div class="alert-message alert-message-danger" role="alert">
              <h4>Error</h4>
              Sorry, <strong>{{ status_object }}</strong> cannot be found.
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  {% endif %}
    <div class="col-xs-12 col-sm-12 col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="panel-title">
            Current Loans
          </div>
        </div>
        <div class="panel-body">
          {% if borrowers|length > 0 %}
            <div class="table-responsive">
              <table id="myTable" class="table table-hover table-condensed">
                <thead>
                  <tr>
                    <th colspan=2>Person</th>
                    <th>Item</th>
                  </tr>
                </thead>
                {% for person in borrowers %}
                  <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>
                      <a href="{% url 'checkout.views.person_detail' id_number=person.id_number %}">{{ person }}</a> <small class="hidden-xs text-muted">{{ person.id_number }}</small>
                      <td class="pull-right">
                      {% for transaction in person.inventory %}
                        {{ transaction.item.name }} <small class="hidden-xs text-muted">{{transaction.item.inventory_tag}}</small><br/>
                      {% endfor %}
                      </td>
                    </td>
                  </tr>
                {% endfor %}
              </table>
          </div>
        {% else %}
          No items on loan.
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% include 'checkout/popup.html' %}
{% endblock content %}
